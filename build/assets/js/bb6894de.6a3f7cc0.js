"use strict";(self.webpackChunksemaphore_docs=self.webpackChunksemaphore_docs||[]).push([[8339],{4404:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>o,contentTitle:()=>r,default:()=>h,frontMatter:()=>a,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"user-guide/task-templates/apps/ansible","title":"ansible","description":"Task templates","source":"@site/docs/user-guide/task-templates/apps/ansible.md","sourceDirName":"user-guide/task-templates/apps","slug":"/user-guide/task-templates/apps/ansible","permalink":"/user-guide/task-templates/apps/ansible","draft":false,"unlisted":false,"editUrl":"https://github.com/semaphoreui/semaphore-docs/edit/main/docs/user-guide/task-templates/apps/ansible.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Task Templates","permalink":"/user-guide/task-templates/"},"next":{"title":"terraform","permalink":"/user-guide/task-templates/apps/terraform"}}');var n=t(4848),l=t(8453);const a={},r="Ansible",o={},d=[{value:"Task",id:"task",level:3},{value:"Build",id:"build",level:3},{value:"Deploy",id:"deploy",level:3},{value:"Schedule",id:"schedule",level:3},{value:"Run a task when a new commit is added to the repository",id:"run-a-task-when-a-new-commit-is-added-to-the-repository",level:4},{value:"Tags, skip-tags and limit",id:"tags-skip-tags-and-limit",level:3},{value:"Multiple vault passwords",id:"multiple-vault-passwords",level:3},{value:"Verbosity level",id:"verbosity-level",level:3}];function c(e){const s={a:"a",code:"code",em:"em",h1:"h1",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{class:"breadcrumbs",children:(0,n.jsxs)(s.p,{children:[(0,n.jsx)("a",{href:"/user-guide/task-templates/",children:"Task templates"}),"\n\u2192 Ansible"]})}),"\n",(0,n.jsx)(s.header,{children:(0,n.jsx)(s.h1,{id:"ansible",children:"Ansible"})}),"\n",(0,n.jsxs)(s.p,{children:["Using Semaphore UI you can run Ansible playbooks. To do this, you need to create an ",(0,n.jsx)(s.strong,{children:"Ansible Playbook"})," Template."]}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:["Go go ",(0,n.jsx)(s.strong,{children:"Task Templates"})," section, click on ",(0,n.jsx)(s.strong,{children:"New Template"})," and then ",(0,n.jsx)(s.strong,{children:"Ansible Playbook"}),"."]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsx)(s.p,{children:"Set up the template."}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(s.p,{children:"The template allows you to specify the following parameters:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"Repository"}),"\n",(0,n.jsx)(s.li,{children:"Path to playbook file"}),"\n",(0,n.jsx)(s.li,{children:"Inventory"}),"\n",(0,n.jsx)(s.li,{children:"Variable Groups"}),"\n",(0,n.jsx)(s.li,{children:"Vaults"}),"\n",(0,n.jsx)(s.li,{children:"and much more"}),"\n"]}),"\n",(0,n.jsx)(s.p,{children:"An ansible-playbook template can be one of the following types:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.a,{href:"#task",children:"Task"})}),"\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.a,{href:"#build",children:"Build"})}),"\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.a,{href:"#deploy",children:"Deploy"})}),"\n"]}),"\n",(0,n.jsx)(s.h3,{id:"task",children:"Task"}),"\n",(0,n.jsx)(s.p,{children:"Just runs specified playbooks with specified parameters."}),"\n",(0,n.jsxs)(s.p,{children:["If you intend to launch the template with an API call with the ",(0,n.jsx)(s.em,{children:"limit"})," feature, make sure to activate the option ",(0,n.jsx)(s.em,{children:"Ansible prompts: Limit"}),". Otherwise the limit set in the API call will be ignored. For the API triggered task, this will not cause any interactive prompt, the task will run unattended."]}),"\n",(0,n.jsx)(s.h3,{id:"build",children:"Build"}),"\n",(0,n.jsxs)(s.p,{children:["This type of template should be used to create ",(0,n.jsx)(s.a,{href:"https://en.wikipedia.org/wiki/Artifact_(software_development)",children:"artifacts"}),". The start version of the artifact can be specified in a template parameter. Each run increments the artifact version."]}),"\n",(0,n.jsxs)(s.p,{children:["Semaphore doesn't support artifacts out-of-box, it only provides task versioning. You should implement the artifact creation yourself. Read the article ",(0,n.jsx)(s.a,{href:"../../administration-guide/cicd.md",children:"CI/CD"})," to know how to do this."]}),"\n",(0,n.jsx)(s.h3,{id:"deploy",children:"Deploy"}),"\n",(0,n.jsxs)(s.p,{children:["This type of template should be used to deploy artifacts to the destination servers. Each ",(0,n.jsx)(s.code,{children:"deploy"})," template is associated with a ",(0,n.jsx)(s.code,{children:"build"})," template."]}),"\n",(0,n.jsx)(s.p,{children:"This allows you to deploy a specific version of the artifact to the servers."}),"\n",(0,n.jsx)(s.h3,{id:"schedule",children:"Schedule"}),"\n",(0,n.jsxs)(s.p,{children:["You can set up task scheduling by specifying a cron schedule in the template settings. Cron expression format you can find in ",(0,n.jsx)(s.a,{href:"https://pkg.go.dev/github.com/robfig/cron/v3#hdr-CRON_Expression_Format",children:"documentation"}),"."]}),"\n",(0,n.jsx)(s.h4,{id:"run-a-task-when-a-new-commit-is-added-to-the-repository",children:"Run a task when a new commit is added to the repository"}),"\n",(0,n.jsx)(s.p,{children:"You can use cron to periodically check for new commits in the repository and trigger a task upon their arrival."}),"\n",(0,n.jsxs)(s.p,{children:["For example you have source code of the app in the git repository. You can add it to ",(0,n.jsx)(s.strong,{children:"Repositories"})," and trigger the Build task for new commits."]}),"\n",(0,n.jsx)(s.h3,{id:"tags-skip-tags-and-limit",children:"Tags, skip-tags and limit"}),"\n",(0,n.jsx)(s.p,{children:"Templates support Ansible CLI options:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.code,{children:"--tags"})}),"\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.code,{children:"--skip-tags"})}),"\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.code,{children:"--limit"})}),"\n"]}),"\n",(0,n.jsx)(s.p,{children:"These can be set in the template and overridden when creating a task. Ensure corresponding prompts are enabled if you plan to pass these values via API."}),"\n",(0,n.jsx)(s.h3,{id:"multiple-vault-passwords",children:"Multiple vault passwords"}),"\n",(0,n.jsx)(s.p,{children:"You can attach multiple Vault passwords from the Key Store to a template. During execution, Ansible will attempt to decrypt using the provided passwords."}),"\n",(0,n.jsx)(s.h3,{id:"verbosity-level",children:"Verbosity level"}),"\n",(0,n.jsxs)(s.p,{children:["You can adjust Ansible verbosity for a task (for example ",(0,n.jsx)(s.code,{children:"-v"}),", ",(0,n.jsx)(s.code,{children:"-vvv"}),") from the template/task form to aid troubleshooting."]})]})}function h(e={}){const{wrapper:s}={...(0,l.R)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(c,{...e})}):c(e)}},8453:(e,s,t)=>{t.d(s,{R:()=>a,x:()=>r});var i=t(6540);const n={},l=i.createContext(n);function a(e){const s=i.useContext(l);return i.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function r(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:a(e.components),i.createElement(l.Provider,{value:s},e.children)}}}]);