"use strict";(self.webpackChunksemaphore_docs=self.webpackChunksemaphore_docs||[]).push([[885],{8453:(e,s,i)=>{i.d(s,{R:()=>a,x:()=>o});var n=i(6540);const r={},t=n.createContext(r);function a(e){const s=n.useContext(t);return n.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),n.createElement(t.Provider,{value:s},e.children)}},8941:(e,s,i)=>{i.r(s),i.d(s,{assets:()=>d,contentTitle:()=>o,default:()=>p,frontMatter:()=>a,metadata:()=>n,toc:()=>l});const n=JSON.parse('{"id":"administration-guide/cicd","title":"Pipelines","description":"Semaphore supports simple pipelines with using build and deploy tasks.","source":"@site/docs/administration-guide/cicd.md","sourceDirName":"administration-guide","slug":"/administration-guide/cicd","permalink":"/administration-guide/cicd","draft":false,"unlisted":false,"editUrl":"https://github.com/semaphoreui/semaphore-docs/edit/main/docs/administration-guide/cicd.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"API","permalink":"/administration-guide/api"},"next":{"title":"Runners","permalink":"/administration-guide/runners"}}');var r=i(4848),t=i(8453);const a={},o="Pipelines",d={},l=[{value:"Build",id:"build",level:3},{value:"Deploy",id:"deploy",level:3}];function c(e){const s={a:"a",code:"code",h1:"h1",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.header,{children:(0,r.jsx)(s.h1,{id:"pipelines",children:"Pipelines"})}),"\n",(0,r.jsxs)(s.p,{children:["Semaphore supports simple pipelines with using ",(0,r.jsx)(s.code,{children:"build"})," and ",(0,r.jsx)(s.code,{children:"deploy"})," tasks."]}),"\n",(0,r.jsxs)(s.p,{children:["Semaphore passes ",(0,r.jsx)(s.code,{children:"semaphore_vars"})," variable to each Ansible playbook which it runs."]}),"\n",(0,r.jsx)(s.p,{children:"You can use it in your Ansible tasks to get what type of task was run, which version should be build or deployed, who ran the task, etc."}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsxs)(s.p,{children:["Example of ",(0,r.jsx)(s.code,{children:"semaphore_vars"})," for ",(0,r.jsx)(s.code,{children:"build"})," tasks:"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-yaml",children:"semaphore_vars:\n    task_details:\n        type: build\n        username: user123\n        message: New version of some feature\n        target_version: 1.5.33\n"})}),"\n",(0,r.jsxs)(s.p,{children:["Example of ",(0,r.jsx)(s.code,{children:"semaphore_vars"})," for ",(0,r.jsx)(s.code,{children:"deploy"})," tasks:"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-yaml",children:"semaphore_vars:\n    task_details:\n        type: deploy\n        username: user123\n        message: Deploy new feature to servers\n        incoming_version: 1.5.33\n"})}),"\n",(0,r.jsx)(s.h3,{id:"build",children:"Build"}),"\n",(0,r.jsxs)(s.p,{children:["This type of task is used to create ",(0,r.jsx)(s.a,{href:"https://en.wikipedia.org/wiki/Artifact_(software_development)",children:"artifacts"}),". Each build task has autogenerated version. You should use variable ",(0,r.jsx)(s.code,{children:"semaphore_vars.task_details.target_version"})," in your Ansible playbook to get what version of the artifact should be created. After the artifact is created, it can be used for deployment."]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsxs)(s.p,{children:["Example of ",(0,r.jsx)(s.code,{children:"build"})," Ansible role:"]}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsx)(s.li,{children:"Get app source code from GitHub"}),"\n",(0,r.jsx)(s.li,{children:"Compile source code"}),"\n",(0,r.jsxs)(s.li,{children:["Pack created binary to a tarball with name ",(0,r.jsx)(s.code,{children:"app-{{semaphore_vars.task_details.target_version}}.tar.gz"})]}),"\n",(0,r.jsxs)(s.li,{children:["Send ",(0,r.jsx)(s.code,{children:"app-{{semaphore_vars.task_details.target_version}}.tar.gz"})," to an S3 bucket"]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"deploy",children:"Deploy"}),"\n",(0,r.jsxs)(s.p,{children:["This type of task is used to deploy artifacts to destination servers. Each deployment task is associated with the build task. You should use variable ",(0,r.jsx)(s.code,{children:"semaphore_vars.task_details.incoming_version"})," in your Ansible playbook to get what version of the artifact should be deployed."]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsxs)(s.p,{children:["Example of ",(0,r.jsx)(s.code,{children:"deploy"})," Ansible role:"]}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["Download ",(0,r.jsx)(s.code,{children:"app-{{semaphore_vars.task_details.incoming_version}}.tar.gz"})," from an S3 bucket to destination servers"]}),"\n",(0,r.jsxs)(s.li,{children:["Unpack ",(0,r.jsx)(s.code,{children:"app-{{semaphore_vars.task_details.incoming_version}}.tar.gz"})," to destination directory"]}),"\n",(0,r.jsx)(s.li,{children:"Create or update configuration files"}),"\n",(0,r.jsx)(s.li,{children:"Restart app service"}),"\n"]})]})}function p(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}}}]);