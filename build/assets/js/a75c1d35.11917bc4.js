"use strict";(self.webpackChunksemaphore_docs=self.webpackChunksemaphore_docs||[]).push([[8220],{6276:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>h,contentTitle:()=>a,default:()=>l,frontMatter:()=>o,metadata:()=>i,toc:()=>u});const i=JSON.parse('{"id":"administration-guide/runners","title":"Runners","description":"Runners enable running tasks on a separate server from Semaphore UI.","source":"@site/docs/administration-guide/runners.md","sourceDirName":"administration-guide","slug":"/administration-guide/runners","permalink":"/administration-guide/runners","draft":false,"unlisted":false,"editUrl":"https://github.com/semaphoreui/semaphore-docs/edit/main/docs/administration-guide/runners.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Pipelines","permalink":"/administration-guide/cicd"},"next":{"title":"Logs","permalink":"/administration-guide/logs"}}');var s=r(4848),t=r(8453);const o={},a="Runners",h={},u=[{value:"Set up",id:"set-up",level:2},{value:"Set up a server",id:"set-up-a-server",level:3},{value:"Setup a runner",id:"setup-a-runner",level:3},{value:"Registering the runner on the server",id:"registering-the-runner-on-the-server",level:3},{value:"Adding the runner via the web UI",id:"adding-the-runner-via-the-web-ui",level:4},{value:"Registering via CLI",id:"registering-via-cli",level:4},{value:"Configuration file",id:"configuration-file",level:3},{value:"Running the runner",id:"running-the-runner",level:2},{value:"Runner tags (Pro)",id:"runner-tags-pro",level:3},{value:"Runner unregistaration",id:"runner-unregistaration",level:2},{value:"Security",id:"security",level:2}];function c(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"runners",children:"Runners"})}),"\n",(0,s.jsx)(n.p,{children:"Runners enable running tasks on a separate server from Semaphore UI."}),"\n",(0,s.jsx)(n.p,{children:"Semaphore runners operate on the same principle as GitLab or GitHub Actions runners:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"You launch a runner on a separate server, specifying the Semaphore server's address and an authentication token."}),"\n",(0,s.jsx)(n.li,{children:"The runner connects to Semaphore and signals its readiness to accept tasks."}),"\n",(0,s.jsx)(n.li,{children:"When a new task appears, Semaphore provides all the necessary information to the runner, which, in turn, clones the repository and runs Ansible, Terraform, PowerShell, etc."}),"\n",(0,s.jsx)(n.li,{children:"The runner sends the task execution results back to Semaphore."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"For end users, working with Semaphore with or without runners appears the same."}),"\n",(0,s.jsx)(n.p,{children:"Using runners offers the following advantages:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Executing tasks more securely. For instance, a runner can be located within a closed subnet or isolated docker container."}),"\n",(0,s.jsx)(n.li,{children:"Distributing the workload across multiple servers. You can start multiple runners, and tasks will be randomly distributed among them."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"set-up",children:"Set up"}),"\n",(0,s.jsx)(n.h3,{id:"set-up-a-server",children:"Set up a server"}),"\n",(0,s.jsx)(n.p,{children:"To set up the server for working with running you should add following option to your Semaphore server configuration:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "use_remote_runner": true,\n  "runner_registration_token": "long string of random characters"\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"or with using environment variables:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"SEMAPHORE_USE_REMOTE_RUNNER=True\nSEMAPHORE_RUNNER_REGISTRATION_TOKEN=long_string_of_random_characters\n"})}),"\n",(0,s.jsx)(n.h3,{id:"setup-a-runner",children:"Setup a runner"}),"\n",(0,s.jsx)(n.p,{children:"To set up the runner, use the following command:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"semaphore runner setup --config /path/to/your/config/file.json\n"})}),"\n",(0,s.jsxs)(n.p,{children:["This command will create a configuration file at ",(0,s.jsx)(n.code,{children:"/path/to/your/config/file.json"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"But before using this command, you need to understand how runners are registered on the server."}),"\n",(0,s.jsx)(n.h3,{id:"registering-the-runner-on-the-server",children:"Registering the runner on the server"}),"\n",(0,s.jsx)(n.p,{children:"There are two ways to register a runner on the Semaphore server:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Add it via the web interface or API."}),"\n",(0,s.jsxs)(n.li,{children:["Use the command line with the ",(0,s.jsx)(n.code,{children:"semaphore runner register"})," command."]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"adding-the-runner-via-the-web-ui",children:"Adding the runner via the web UI"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://github.com/user-attachments/assets/8b0f7890-5767-4139-932d-3e39c217fd57",alt:"Runner Image"})}),"\n",(0,s.jsx)(n.h4,{id:"registering-via-cli",children:"Registering via CLI"}),"\n",(0,s.jsxs)(n.p,{children:["To register a runner this way, you need to add the ",(0,s.jsx)(n.code,{children:"runner_registration_token"})," option to your Semaphore server's configuration file. This option should be set to an arbitrary string. Choose a sufficiently complex string to avoid security issues."]}),"\n",(0,s.jsxs)(n.p,{children:["When the ",(0,s.jsx)(n.code,{children:"semaphore runner setup"})," command asks if you have a Runner token, answer No. Then use the following command to register the runner:"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"semaphore runner register --config /path/to/your/config/file.json"})}),"\n",(0,s.jsx)(n.p,{children:"or"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"echo REGISTRATION_TOKEN | semaphore runner register --stdin-registration-token --config /path/to/your/config/file.json"})}),"\n",(0,s.jsx)(n.h3,{id:"configuration-file",children:"Configuration file"}),"\n",(0,s.jsxs)(n.p,{children:["As a result of running the ",(0,s.jsx)(n.code,{children:"semaphore runner setup"})," command, a configuration file like the following will be created:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "tmp_path": "/tmp/semaphore",\n  "web_host": "https://semaphore_server_host",\n\n  // Here you can provide other settings, for example: git_client, ssh_config_path, etc.\n  // ...\n  \n  // Runner specific options\n  "runner": {\n    "token": "your runner\'s token",\n    // or\n    "token_file": "path/to/the/file/where/runner/saves/token"\n\n    // Here you can provide other runner-specific options, \n    // which will be used for runner registration, for example: \n    // max_parallel_tasks, webhook, one_off, etc.\n    // ...\n  }\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:["You can manually edit this file without needing to call ",(0,s.jsx)(n.code,{children:"semaphore runner setup"})," again."]}),"\n",(0,s.jsxs)(n.p,{children:["To re-register the runner, you can use the ",(0,s.jsx)(n.code,{children:"semaphore runner register"})," command. This will overwrite the token in the file specified in the configuration."]}),"\n",(0,s.jsx)(n.h2,{id:"running-the-runner",children:"Running the runner"}),"\n",(0,s.jsx)(n.p,{children:"Now you can start the runner with the command:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"semaphore runner start --config /path/to/your/config/file.json\n"})}),"\n",(0,s.jsx)(n.p,{children:"Your runner is ready to execute tasks ;)"}),"\n",(0,s.jsx)(n.h3,{id:"runner-tags-pro",children:"Runner tags (Pro)"}),"\n",(0,s.jsx)(n.p,{children:"You can assign one or more tags to a project runner. Templates can then require a tag so tasks run only on matching runners. Configure tags when adding a runner in the project UI, and set the required tag in the template settings."}),"\n",(0,s.jsx)(n.h2,{id:"runner-unregistaration",children:"Runner unregistaration"}),"\n",(0,s.jsx)(n.p,{children:"You can remove runner using the web interfance."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://github.com/user-attachments/assets/431291eb-8f48-42c1-b56e-87fc8e9ba040",alt:"Runner Image"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.p,{children:"Or unregister runner via CLI:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"semaphore runner unregister --config /path/to/your/config/file.json\n"})}),"\n",(0,s.jsx)(n.h2,{id:"security",children:"Security"}),"\n",(0,s.jsx)(n.p,{children:"Data transfer security is ensured by using asymmetric encryption: the server encrypts data using a public key, the runner decrypts it using a private key."}),"\n",(0,s.jsx)(n.p,{children:"Public and private keys are generated automatically when the runner registers on the server."}),"\n",(0,s.jsx)("div",{class:"warning",children:(0,s.jsx)(n.p,{children:"Use the HTTPS protocol for communication between the server and the runner, especially if they are not on the same private network."})})]})}function l(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>a});var i=r(6540);const s={},t=i.createContext(s);function o(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);